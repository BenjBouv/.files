set nocompatible    " do not try to be vi-compatible

set guifont=Inconsolata\ 11

set textwidth=79
set wrap            " auto wrap line view, but not text itself

filetype indent on  " activates indenting for files
set softtabstop=4   " width of a tab
set tabstop=4
set shiftwidth=4    " width of the indentation
set expandtab

set ignorecase      " case-insentive search by default
set smartcase       " search case-sensitive if there is an upper-case letter
set gdefault        " when replacing, use /g by default
set showmatch       " paren match highlighting
set hlsearch        " highlight what you search for
set incsearch       " type-ahead-find
set wildmenu        " command-line completion shows a list of matches
set wildmode=longest,list:longest,full " Bash-vim completion behavior
set autochdir       " use current working directory of a file as base path

set encoding=utf-8

set nu              " show line numbers
set showmode        " show the current mode on the last line
set showcmd         " show informations about selection while in visual mode

set guioptions-=T   "remove toolbar

set colorcolumn=80,100  " highligth the 80th and 120th column

"set cursorline " highlight current line

" all operations such as yy, D, and P work with the clipboard.
" No need to prefix them with "* or "+
set clipboard=unnamed

" New split placed below
set splitbelow
" New vsplit placed right
set splitright

" set foldmethod=syntax " makes vim horribly slow, with syntax coloring
set foldlevelstart=20 " buffer are always loaded with opened folds

" always keep lines around the cursor
set scrolloff=5

" Yank the line, comment it, paste it
nnoremap yp yygccp

" When jumping to a given line, center the screen
nnoremap G Gzz

" print tabs with a special character (add ",eol:·" for end of lines)
set listchars=trail:·,nbsp:·,tab:▸\ ,extends:»,precedes:«,
set list

set laststatus=2    " always show the statusline, even when there is only one file edited

" move the current line up or down with the Ctrl-arrow keys
nmap <C-Down> :<C-u>move .+1<CR>
nmap <C-Up>   :<C-u>move .-2<CR>
imap <C-Down> <C-o>:<C-u>move .+1<CR>
imap <C-Up>   <C-o>:<C-u>move .-2<CR>
vmap <C-Down> :move '>+1<CR>gv
vmap <C-Up> :move '<-2<CR>gv

filetype plugin on
set ofu=syntaxcomplete#Complete

" autocomplétion with <TAB> instead of <C-n>, depending on the context
"   function! Smart_TabComplete()
"     let line = getline('.')                         " curline
"     let substr = strpart(line, -1, col('.')+1)      " from start to cursor
"     let substr = matchstr(substr, "[^ \t]*$")       " word till cursor
"     if (strlen(substr)==0)                          " nothing to match on empty string
"       return "\<tab>"
"     endif
"     let has_period = match(substr, '\.') != -1      " position of period, if any
"     let has_slash = match(substr, '\/') != -1       " position of slash, if any
"     if (!has_period && !has_slash)
"       return "\<C-X>\<C-P>"                         " existing text matching
"     elseif ( has_slash )
"       return "\<C-X>\<C-F>"                         " file matching
"     else
"       return "\<C-X>\<C-O>"                         " plugin matching
"     endif
"   endfunction

" inoremap <tab> <c-r>=Smart_TabComplete()<CR>

" OmniCppComplete
"let OmniCpp_NamespaceSearch = 1
"let OmniCpp_GlobalScopeSearch = 1
"let OmniCpp_ShowAccess = 1
"let OmniCpp_ShowPrototypeInAbbr = 1 " show function parameters
"let OmniCpp_MayCompleteDot = 1 " autocomplete after .
"let OmniCpp_MayCompleteArrow = 1 " autocomplete after ->
"let OmniCpp_MayCompleteScope = 1 " autocomplete after ::
"let OmniCpp_DefaultNamespaces = ["std", "_GLIBCXX_STD"]

" close the buffer without deleting its window
":runtime plugins/bclose.vim
"nmap :bc <Plug>Kwbd

"ctags
map <C-\> :vsp <CR>:exec("tag ".expand("<cword>"))<CR>
set tags=./tags;/

source ~/.files/conf/bundles.vim

" config da detectindent
"let g:detectindent_preferred_expandtab = 1
"let g:detectindent_preferred_indent = 4
"autocmd BufNewFile,BufReadPost * :DetectIndent
"autocmd FileType make setlocal noexpandtab

" config da Tagbar
"nmap <F8> :TagbarToggle<CR>
"let g:tagbar_autofocus = 1

" older regexp engine, makes vim faster?
syntax on             " syntax coloring by default
set re=1

" In case syntax coloring is slow, deactivate the next three options
" set nocursorcolumn
" set nocursorline
" syntax sync minlines=256

" Deactivate the arrow keys.
noremap <Up> <Nop>
noremap <Down> <Nop>
noremap <Left> <Nop>
noremap <Right> <Nop>
vnoremap <Up> <Nop>
vnoremap <Down> <Nop>
vnoremap <Left> <Nop>
vnoremap <Right> <Nop>
inoremap <Up> <Nop>
inoremap <Down> <Nop>
inoremap <Left> <Nop>
inoremap <Right> <Nop>

autocmd! BufWritePost .vimrc source /home/ben/.vimrc

" Define leader
let mapleader = ' '

" Activate CtrlP with <leader>f (find)
noremap <leader>f :CtrlP<CR>

" erases the highlight on search
map <silent> <leader><CR> :noh<CR>

" build tags of your own project with <leader>T (T is for tags)
map <leader>T :exec '!ctags --recurse --append --sort=yes --c++-kinds=+p --fields=+iaS --extra=+q'<CR>

" show next tag match
map <leader><Space> :tn<CR>

" open reject file <leader>R (R is for rejects)
map <silent> <leader>R :vs %.rej<CR>

" side pane of files (n is for nerdtree)
nnoremap <leader>n :NERDTreeToggle<cr>

" side pane of class and functions
"map <F11> :TlistToggle<cr>
"nmap <F11> :TagbarToggle<CR>
"nnoremap <leader>b :TagbarToggle<CR>

" Solarized
set background=dark
set rtp+=~/.vim/bundle/vim-colors-solarized/
let g:solarized_termcolors=256
colorscheme solarized

set ruler

" reselect visual block after indent/outdent
vnoremap < <gv
vnoremap > >gv

" magic for backspace and delete issues in terminal mode
set backspace=indent,eol,start

nmap <leader>p <Plug>yankstack_substitute_newer_paste
nmap <leader>P <Plug>yankstack_substitute_older_paste

let g:multi_cursor_use_default_mapping=0
let g:multi_cursor_next_key='<C-m>'
let g:multi_cursor_prev_key='<C-p>'
let g:multi_cursor_quit_key='<esc>'

" deoplete
let g:deoplete#enable_at_startup = 1

" LANGAGE SERVER CONFIG
set hidden

let g:LanguageClient_serverCommands = {
    \ 'rust': ['rustup', 'run', 'nightly', 'rls'],
    \ }

" Automatically start language servers.
let g:LanguageClient_autoStart = 1

nnoremap <silent> Kh :call LanguageClient_textDocument_hover()<CR>
nnoremap <silent> Kr :call LanguageClient_textDocument_references()<CR>
nnoremap <silent> KR :call LanguageClient_textDocument_rename()<CR>"
nnoremap <silent> gd :call LanguageClient_textDocument_definition()<CR>

" END OF LANGAGE SERVER CONFIG

" Half indent for switch cases
set cino=:0.5s,=0.5s
